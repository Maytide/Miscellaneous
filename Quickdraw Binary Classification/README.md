Based on Coursera CNN course implementation